<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Idonet+ | Plataforma de Formaci√≥n y Asesor√≠a</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons (alternative to emojis for a more professional look) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,600;14..32,800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafc;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 8px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }

        /* Animations */
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Glassmorphism cards */
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        /* Custom gradient */
        .gradient-azure {
            background: linear-gradient(145deg, #0077BE 0%, #005a94 100%);
        }
        .gradient-forest {
            background: linear-gradient(145deg, #2e8b57 0%, #1e5f3a 100%);
        }
        /* Active nav style */
        .nav-active {
            background-color: #1e3a5f;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 119, 190, 0.2);
        }
        /* Map milestone styling */
        .milestone {
            transition: all 0.2s ease;
        }
        .milestone:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 8px 12px rgba(0,0,0,0.15));
        }
        /* File upload button */
        .file-upload-label:hover {
            background-color: #e6f0fa;
        }
        /* Hide default sections initially except dashboard */
        .section:not(#dashboard) {
            display: none;
        }
        /* Chat bot message style */
        .chat-message-bot {
            background-color: #f0f4fa;
            border-radius: 20px 20px 20px 5px;
        }
        .chat-message-user {
            background: #0077BE;
            color: white;
            border-radius: 20px 20px 5px 20px;
        }
        /* Ripple effect for buttons */
        .ripple-btn {
            position: relative;
            overflow: hidden;
        }
    </style>
</head>
<body class="h-screen flex overflow-hidden text-gray-800">

    <!-- ========== SIDEBAR (NAVEGACI√ìN) ========== -->
    <aside class="w-72 bg-white/90 backdrop-blur-md border-r border-gray-200/60 flex flex-col shadow-xl z-20">
        <div class="p-6 border-b border-gray-100">
            <div class="flex items-center gap-2">
                <span class="text-3xl font-black text-blue-700">Idonet<span class="text-green-600">+</span></span>
                <span class="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full font-semibold">BETA</span>
            </div>
            <p class="text-sm text-gray-500 mt-1 font-medium">Formaci√≥n Tecnol√≥gica ¬∑ PNFT 2026</p>
        </div>

        <!-- User Level Card -->
        <div class="mx-4 mt-6 p-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border border-blue-100/50 shadow-sm">
            <div class="flex justify-between items-center">
                <span class="text-xs font-bold text-blue-700 uppercase tracking-wider">Nivel Experto</span>
                <span class="bg-green-500 text-white text-xs px-2 py-0.5 rounded-full font-bold shadow-sm">üî• 5 d√≠as</span>
            </div>
            <div class="flex items-end justify-between mt-3">
                <div>
                    <p class="text-2xl font-black text-gray-800" id="pointsDisplay">2,450</p>
                    <p class="text-xs text-gray-500">IdoPoints</p>
                </div>
                <div class="text-right">
                    <p class="text-sm font-semibold">Pr√≥xima meta</p>
                    <p class="text-xs text-gray-600">Experto STEAM</p>
                </div>
            </div>
            <div class="w-full bg-gray-200/70 h-2 rounded-full mt-4 overflow-hidden">
                <div class="bg-gradient-to-r from-blue-500 to-green-400 h-full rounded-full transition-all duration-700" id="levelProgressBar" style="width: 68%"></div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <nav class="flex-1 px-4 py-6 space-y-1.5">
            <button onclick="showSection('dashboard', this)" class="nav-btn w-full flex items-center gap-4 p-3.5 rounded-xl hover:bg-blue-50 transition-all text-gray-700 font-medium group nav-active">
                <i class="fas fa-chart-pie text-xl w-6 text-blue-600"></i> <span>Dashboard</span>
            </button>
            <button onclick="showSection('focus', this)" class="nav-btn w-full flex items-center gap-4 p-3.5 rounded-xl hover:bg-blue-50 transition-all text-gray-700 font-medium group">
                <i class="fas fa-brain text-xl w-6 text-indigo-500"></i> <span>Modo Enfoque</span>
            </button>
            <button onclick="showSection('simulator', this)" class="nav-btn w-full flex items-center gap-4 p-3.5 rounded-xl hover:bg-blue-50 transition-all text-gray-700 font-medium group">
                <i class="fas fa-clipboard-list text-xl w-6 text-amber-600"></i> <span>Simulador MEP</span>
            </button>
            <button onclick="showSection('tutor', this)" class="nav-btn w-full flex items-center gap-4 p-3.5 rounded-xl hover:bg-blue-50 transition-all text-gray-700 font-medium group">
                <i class="fas fa-robot text-xl w-6 text-emerald-600"></i> <span>Tutor IA</span>
            </button>
            <button onclick="showSection('recursos', this)" class="nav-btn w-full flex items-center gap-4 p-3.5 rounded-xl hover:bg-blue-50 transition-all text-gray-700 font-medium group">
                <i class="fas fa-book-open text-xl w-6 text-purple-600"></i> <span>Centro Recursos</span>
            </button>
        </nav>

        <div class="p-4 border-t border-gray-100 text-xs text-gray-400 text-center">
            v2.6.0 ¬∑ Asesor√≠a continua
        </div>
    </aside>

    <!-- ========== CONTENIDO PRINCIPAL ========== -->
    <main class="flex-1 overflow-y-auto bg-[#f5f7fb] relative">
        <!-- Header Din√°mico -->
        <header class="sticky top-0 z-10 bg-white/70 backdrop-blur-xl border-b border-gray-200/60 px-8 py-4 flex justify-between items-center">
            <h2 id="pageTitle" class="text-xl font-bold text-gray-800">Panel Principal</h2>
            <div class="flex items-center gap-4">
                <button class="p-2.5 hover:bg-gray-100 rounded-full transition">
                    <i class="far fa-bell text-gray-600"></i>
                </button>
                <div class="h-10 w-10 rounded-full gradient-azure text-white flex items-center justify-center font-bold shadow-md">DR</div>
            </div>
        </header>

        <!-- Contenedor de Secciones (cada secci√≥n se muestra/oculta) -->
        <div class="p-6 md:p-8 max-w-6xl mx-auto pb-16">

            <!-- ===== SECCI√ìN DASHBOARD (con mapa de metas) ===== -->
            <section id="dashboard" class="section fade-in">
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-600 mb-2">Bienvenido, Dr. Ram√≠rez</h3>
                    <p class="text-3xl font-black text-gray-800">Construyendo ciudadan√≠a digital üå±</p>
                </div>

                <!-- Mapa de Metas Volantes (estilo Duolingo) -->
                <div class="bg-white p-6 rounded-3xl shadow-md border border-gray-100 mb-10 overflow-x-auto">
                    <div class="flex items-center gap-1 mb-6">
                        <i class="fas fa-map-signs text-blue-500 mr-2"></i>
                        <h4 class="font-bold text-gray-700">Camino a la Maestr√≠a ¬∑ PNFT 2026</h4>
                        <span class="ml-auto text-sm text-gray-400">9 metas restantes</span>
                    </div>
                    <div class="flex justify-between items-center min-w-[700px] py-2">
                        <!-- Meta 1 (completada) -->
                        <div class="flex flex-col items-center milestone">
                            <div class="w-14 h-14 rounded-full bg-green-100 border-2 border-green-500 flex items-center justify-center text-2xl shadow-md cursor-pointer" onclick="claimReward(100, 'Fundamentos digitales')">
                                <i class="fas fa-check-circle text-green-600"></i>
                            </div>
                            <span class="text-xs font-bold mt-2 text-gray-600">Fundamentos</span>
                        </div>
                        <div class="h-1 w-12 bg-green-300 rounded-full"></div>
                        <!-- Meta 2 (activa) -->
                        <div class="flex flex-col items-center milestone">
                            <div class="w-16 h-16 rounded-full bg-blue-100 border-4 border-blue-500 flex items-center justify-center text-2xl shadow-lg cursor-pointer" onclick="claimReward(150, 'DUA en el aula')">
                                <i class="fas fa-universal-access text-blue-600"></i>
                            </div>
                            <span class="text-xs font-bold mt-2 text-blue-700">DUA</span>
                        </div>
                        <div class="h-1 w-12 bg-gray-200 rounded-full"></div>
                        <!-- Meta 3 (bloqueada) -->
                        <div class="flex flex-col items-center milestone opacity-40">
                            <div class="w-14 h-14 rounded-full bg-gray-100 border-2 border-gray-300 flex items-center justify-center text-2xl">
                                <i class="fas fa-lock text-gray-400"></i>
                            </div>
                            <span class="text-xs font-bold mt-2 text-gray-400">STEAM</span>
                        </div>
                        <div class="h-1 w-12 bg-gray-200 rounded-full"></div>
                        <!-- Meta 4 (bloqueada) -->
                        <div class="flex flex-col items-center milestone opacity-40">
                            <div class="w-14 h-14 rounded-full bg-gray-100 border-2 border-gray-300 flex items-center justify-center text-2xl">
                                <i class="fas fa-lock text-gray-400"></i>
                            </div>
                            <span class="text-xs font-bold mt-2 text-gray-400">Evaluaci√≥n</span>
                        </div>
                        <div class="h-1 w-12 bg-gray-200 rounded-full"></div>
                        <!-- Meta 5 (premio) -->
                        <div class="flex flex-col items-center milestone">
                            <div class="w-16 h-16 rounded-full bg-amber-100 border-4 border-amber-400 flex items-center justify-center text-3xl shadow-lg cursor-pointer" onclick="claimReward(500, 'Bono Innovaci√≥n + Certificado')">
                                <i class="fas fa-crown text-amber-500"></i>
                            </div>
                            <span class="text-xs font-bold mt-2 text-amber-600">Premio</span>
                        </div>
                    </div>
                </div>

                <!-- KPIs r√°pidos -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-5">
                    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-gray-500 font-medium">Retenci√≥n</p>
                                <h5 class="text-2xl font-black mt-1">85<span class="text-sm font-normal text-gray-400">%</span></h5>
                            </div>
                            <i class="fas fa-brain text-3xl text-indigo-300"></i>
                        </div>
                        <p class="text-xs text-green-600 font-semibold mt-2">+12% vs ayer</p>
                    </div>
                    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-gray-500 font-medium">Fatiga percibida</p>
                                <h5 class="text-2xl font-black mt-1">2.4</h5>
                            </div>
                            <i class="fas fa-heartbeat text-3xl text-rose-300"></i>
                        </div>
                        <p class="text-xs text-green-600 font-semibold mt-2">bajo</p>
                    </div>
                    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-gray-500 font-medium">Enfoque profundo</p>
                                <h5 class="text-2xl font-black mt-1">187 min</h5>
                            </div>
                            <i class="fas fa-clock text-3xl text-blue-300"></i>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Meta: 250 min</p>
                    </div>
                    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-gray-500 font-medium">Racha</p>
                                <h5 class="text-2xl font-black mt-1">5 d√≠as üî•</h5>
                            </div>
                            <i class="fas fa-calendar-check text-3xl text-emerald-300"></i>
                        </div>
                    </div>
                </div>

                <!-- Acci√≥n r√°pida -->
                <div class="mt-8 gradient-azure p-0.5 rounded-3xl shadow-lg">
                    <div class="bg-white/95 backdrop-blur-sm rounded-3xl p-6 flex flex-col md:flex-row items-center justify-between">
                        <div>
                            <h4 class="text-lg font-bold text-gray-800">¬øPreparado para tu sesi√≥n?</h4>
                            <p class="text-sm text-gray-500">Inicia un bloque de 25 min con aislamiento digital.</p>
                        </div>
                        <button onclick="showSection('focus', document.querySelector('.nav-btn[onclick*=\"focus\"]'))" class="mt-3 md:mt-0 gradient-azure text-white px-8 py-3.5 rounded-xl font-bold hover:shadow-xl transition flex items-center gap-2">
                            <i class="fas fa-play"></i> Iniciar Enfoque
                        </button>
                    </div>
                </div>
            </section>

            <!-- ===== SECCI√ìN MODO ENFOQUE ===== -->
            <section id="focus" class="section hidden fade-in">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-black text-gray-800">Modo Flow</h2>
                    <p class="text-gray-500 mt-1">Pomodoro flexible / Flowtime inteligente</p>
                </div>
                <div class="bg-white/80 backdrop-blur-lg p-10 rounded-[60px] shadow-2xl max-w-lg mx-auto border border-white/50">
                    <div class="relative mb-10">
                        <div class="w-48 h-48 mx-auto rounded-full border-8 border-gray-100 flex items-center justify-center shadow-inner">
                            <span id="focusTimer" class="text-6xl font-black text-blue-700">25:00</span>
                        </div>
                        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-56 h-56 rounded-full border-4 border-blue-200/30"></div>
                    </div>
                    <div class="flex justify-center gap-4 mb-8">
                        <button onclick="toggleTimer()" id="timerToggleBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-2xl font-bold shadow-lg shadow-blue-200 transition flex items-center gap-3 text-lg">
                            <i class="fas fa-play"></i> Comenzar
                        </button>
                        <button onclick="resetFocusTimer()" class="bg-gray-100 hover:bg-gray-200 text-gray-700 p-4 rounded-2xl transition">
                            <i class="fas fa-undo-alt"></i>
                        </button>
                    </div>
                    <div class="flex justify-center gap-3">
                        <span class="bg-blue-50 text-blue-700 px-4 py-2 rounded-full text-sm font-semibold flex items-center gap-1"><i class="fas fa-clock"></i> 25/5</span>
                        <span class="bg-green-50 text-green-700 px-4 py-2 rounded-full text-sm font-semibold flex items-center gap-1"><i class="fas fa-spa"></i> Flowtime</span>
                    </div>
                </div>
            </section>

            <!-- ===== SECCI√ìN SIMULADOR MEP ===== -->
            <section id="simulator" class="section hidden fade-in">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Simulador de Idoneidad MEP</h2>
                    <span class="bg-indigo-100 text-indigo-800 px-4 py-2 rounded-full font-bold text-sm">Transitorio 2026</span>
                </div>
                <!-- Estratos selector -->
                <div class="flex gap-2 mb-8 overflow-auto pb-2">
                    <button class="bg-blue-600 text-white px-5 py-2.5 rounded-full text-sm font-bold">I Ciclo</button>
                    <button class="bg-gray-100 text-gray-700 px-5 py-2.5 rounded-full text-sm font-bold">II Ciclo</button>
                    <button class="bg-gray-100 text-gray-700 px-5 py-2.5 rounded-full text-sm font-bold">III Ciclo</button>
                    <button class="bg-gray-100 text-gray-700 px-5 py-2.5 rounded-full text-sm font-bold">Educaci√≥n Diversificada</button>
                </div>

                <!-- Pregunta actual -->
                <div class="bg-white p-8 rounded-3xl shadow-md border border-gray-100">
                    <div class="flex justify-between items-start mb-6">
                        <span class="bg-purple-100 text-purple-800 px-4 py-1.5 rounded-full text-xs font-bold" id="simCategory">Metodolog√≠as Activas</span>
                        <span class="text-gray-400 text-sm" id="simCounter">1 / 3</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-6" id="simQuestion">Pregunta cargando...</h3>
                    <div id="simOptions" class="space-y-3"></div>

                    <!-- Feedback panel -->
                    <div id="simFeedback" class="mt-6 p-5 rounded-xl hidden border-l-8 transition-all">
                        <p class="font-bold text-lg" id="simFeedbackTitle"></p>
                        <p class="text-sm" id="simFeedbackText"></p>
                    </div>
                    <button id="simNextBtn" onclick="nextSimQuestion()" class="mt-6 w-full bg-gray-900 text-white py-4 rounded-xl font-bold hover:bg-gray-800 transition hidden">Siguiente ‚Üí</button>
                </div>
            </section>

            <!-- ===== SECCI√ìN TUTOR IA (con carga de archivos) ===== -->
            <section id="tutor" class="section hidden fade-in">
                <div class="flex flex-col lg:flex-row gap-6 h-[calc(100vh-12rem)]">
                    <!-- Panel de chat -->
                    <div class="flex-1 bg-white rounded-3xl shadow-md border border-gray-100 flex flex-col overflow-hidden">
                        <div class="p-4 border-b border-gray-100 flex items-center gap-3">
                            <i class="fas fa-robot text-2xl text-emerald-600"></i>
                            <span class="font-bold">Asesor PNFT ¬∑ Gemini IA</span>
                        </div>
                        <div id="chatMessages" class="flex-1 p-5 overflow-y-auto space-y-4 bg-gray-50/50">
                            <div class="flex items-start gap-3">
                                <div class="w-9 h-9 rounded-full bg-emerald-600 flex items-center justify-center text-white shrink-0">ü§ñ</div>
                                <div class="chat-message-bot p-4 max-w-[80%] text-gray-700">
                                    Hola, he cargado los lineamientos del MEP. Puedes preguntarme sobre DUA, planeamientos, o crear prompts.
                                </div>
                            </div>
                        </div>
                        <!-- Input con adjuntar archivo -->
                        <div class="p-4 bg-white border-t border-gray-100">
                            <div class="flex items-center gap-2">
                                <label for="fileUpload" class="cursor-pointer p-3 bg-gray-100 hover:bg-gray-200 rounded-2xl transition">
                                    <i class="fas fa-paperclip text-gray-600"></i>
                                    <input type="file" id="fileUpload" class="hidden" accept=".pdf,.docx,.xlsx,.txt" multiple onchange="handleFileUpload(this)">
                                </label>
                                <input type="text" id="chatInput" placeholder="Escribe tu consulta..." class="flex-1 p-4 bg-gray-100 rounded-2xl outline-none focus:ring-2 focus:ring-blue-500" onkeypress="if(event.key==='Enter') sendChatMessage()">
                                <button onclick="sendChatMessage()" class="p-4 bg-blue-600 text-white rounded-2xl hover:bg-blue-700 transition shadow-md">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                            <div id="fileList" class="mt-2 flex flex-wrap gap-2"></div>
                        </div>
                    </div>
                    <!-- Panel de ayuda r√°pida (documentos) -->
                    <div class="lg:w-80 bg-white/70 backdrop-blur rounded-3xl p-5 border border-gray-100 shadow-sm">
                        <h4 class="font-bold text-gray-700 mb-3">üìÅ Documentos cargados</h4>
                        <ul class="space-y-2 text-sm" id="docList">
                            <li class="p-2 bg-blue-50 rounded-lg text-blue-800 flex items-center gap-2"><i class="fas fa-file-pdf"></i> PNFT_marco_2026.pdf</li>
                            <li class="p-2 bg-green-50 rounded-lg text-green-800 flex items-center gap-2"><i class="fas fa-file-word"></i> Lineamientos_evaluacion.docx</li>
                        </ul>
                        <p class="text-xs text-gray-400 mt-4">Sube m√°s archivos para que el asistente aprenda de ellos.</p>
                    </div>
                </div>
            </section>

            <!-- ===== SECCI√ìN CENTRO DE RECURSOS (planeamiento, evaluaci√≥n) ===== -->
            <section id="recursos" class="section hidden fade-in">
                <h2 class="text-2xl font-bold mb-6">Centro de Innovaci√≥n Docente</h2>
                <div class="grid md:grid-cols-3 gap-5">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition">
                        <i class="fas fa-pencil-ruler text-3xl text-blue-500 mb-4"></i>
                        <h3 class="font-bold text-lg">Creador de planeamientos</h3>
                        <p class="text-sm text-gray-500 mb-4">Genera planeaciones con DUA, ejes transversales y RdA.</p>
                        <button class="text-blue-600 font-semibold flex items-center gap-1">Crear <i class="fas fa-arrow-right"></i></button>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition">
                        <i class="fas fa-magic text-3xl text-purple-500 mb-4"></i>
                        <h3 class="font-bold text-lg">Prompts seguros</h3>
                        <p class="text-sm text-gray-500 mb-4">Crea prompts contextualizados por √°rea y nivel.</p>
                        <button class="text-purple-600 font-semibold flex items-center gap-1">Dise√±ar</button>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition">
                        <i class="fas fa-clipboard-check text-3xl text-green-500 mb-4"></i>
                        <h3 class="font-bold text-lg">Instrumentos de evaluaci√≥n</h3>
                        <p class="text-sm text-gray-500 mb-4">R√∫bricas, listas de cotejo basadas en Bloom.</p>
                        <button class="text-green-600 font-semibold flex items-center gap-1">Ejemplos</button>
                    </div>
                </div>
                <div class="mt-8 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                    <h3 class="font-bold text-lg mb-2">Exportar / Importar</h3>
                    <p class="text-sm text-gray-500 mb-4">Sube tu planeamiento en Word o Excel para an√°lisis IA.</p>
                    <div class="flex gap-3">
                        <label class="cursor-pointer bg-gray-100 hover:bg-gray-200 px-5 py-3 rounded-xl font-medium text-sm flex items-center gap-2"><i class="fas fa-upload"></i> Subir archivo<input type="file" class="hidden"></label>
                        <button class="bg-gray-800 text-white px-5 py-3 rounded-xl font-medium text-sm flex items-center gap-2"><i class="fas fa-download"></i> Exportar informe</button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script>
        // ---- GESTI√ìN DE SECCIONES ----
        function showSection(id, btnElement) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('nav-active', 'bg-blue-50', 'text-blue-800');
                btn.classList.add('text-gray-700');
            });
            if (btnElement) {
                btnElement.classList.add('nav-active', 'bg-blue-50', 'text-blue-800');
            }
            const titles = {
                'dashboard': 'Panel Principal',
                'focus': 'Enfoque y Concentraci√≥n',
                'simulator': 'Simulador MEP',
                'tutor': 'Tutor IA',
                'recursos': 'Centro de Recursos'
            };
            document.getElementById('pageTitle').innerText = titles[id] || 'Idonet+';
        }

        // ---- GAMIFICACI√ìN: PUNTOS Y PREMIOS ----
        let points = 2450;
        function claimReward(pointsGain, metaName) {
            points += pointsGain;
            document.getElementById('pointsDisplay').innerText = points.toLocaleString();
            // animar barra de nivel (simulada)
            let progress = document.getElementById('levelProgressBar');
            let newWidth = Math.min(points / 5000 * 100, 100);
            progress.style.width = newWidth + '%';
            alert(`¬°Meta "${metaName}" completada! +${pointsGain} IdoPoints.`);
        }

        // ---- TEMPORIZADOR DE ENFOQUE ----
        let focusTime = 25 * 60;
        let focusInterval = null;
        let focusRunning = false;
        const focusTimerSpan = document.getElementById('focusTimer');
        const toggleBtn = document.getElementById('timerToggleBtn');
        function updateFocusDisplay() {
            let mins = Math.floor(focusTime / 60);
            let secs = focusTime % 60;
            focusTimerSpan.innerText = `${mins}:${secs < 10 ? '0'+secs : secs}`;
        }
        function toggleTimer() {
            if (focusRunning) {
                clearInterval(focusInterval);
                focusRunning = false;
                toggleBtn.innerHTML = '<i class="fas fa-play"></i> Reanudar';
            } else {
                focusInterval = setInterval(() => {
                    if (focusTime > 0) {
                        focusTime--;
                        updateFocusDisplay();
                    } else {
                        clearInterval(focusInterval);
                        focusRunning = false;
                        claimReward(100, 'Sesi√≥n completada');
                        resetFocusTimer();
                    }
                }, 1000);
                focusRunning = true;
                toggleBtn.innerHTML = '<i class="fas fa-pause"></i> Pausar';
            }
        }
        function resetFocusTimer() {
            clearInterval(focusInterval);
            focusRunning = false;
            focusTime = 25 * 60;
            updateFocusDisplay();
            toggleBtn.innerHTML = '<i class="fas fa-play"></i> Comenzar';
        }

        // ---- SIMULADOR MEP - PREGUNTAS (3 preguntas de ejemplo) ----
        const simQuestions = [
            { cat: 'PNFT', question: '¬øCu√°l es el prop√≥sito de la Pol√≠tica Curricular?', options: ['Definir contenidos r√≠gidos', 'Promover adaptaciones seg√∫n contexto', 'Estandarizar ex√°menes'], correct: 1, explanation: 'Busca flexibilidad y pertinencia cultural.' },
            { cat: 'DUA', question: '¬øQu√© principio del DUA se relaciona con el "por qu√©" del aprendizaje?', options: ['M√∫ltiples formas de representaci√≥n', 'M√∫ltiples formas de acci√≥n', 'M√∫ltiples formas de motivaci√≥n'], correct: 2, explanation: 'El compromiso (motivaci√≥n) es el "por qu√©".' },
            { cat: 'Evaluaci√≥n', question: '¬øCu√°l instrumento eval√∫a desempe√±os con niveles de calidad?', options: ['Lista de cotejo', 'R√∫brica', 'Prueba escrita'], correct: 1, explanation: 'La r√∫brica describe niveles de logro.' }
        ];
        let simIndex = 0;
        function loadSimQuestion() {
            let q = simQuestions[simIndex];
            document.getElementById('simCategory').innerText = q.cat;
            document.getElementById('simCounter').innerText = `${simIndex+1} / ${simQuestions.length}`;
            document.getElementById('simQuestion').innerText = q.question;
            let optsDiv = document.getElementById('simOptions');
            optsDiv.innerHTML = '';
            q.options.forEach((opt, idx) => {
                let btn = document.createElement('button');
                btn.className = 'w-full text-left p-4 border-2 border-gray-100 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition font-medium';
                btn.innerText = opt;
                btn.onclick = () => checkSimAnswer(idx, btn);
                optsDiv.appendChild(btn);
            });
            document.getElementById('simFeedback').classList.add('hidden');
            document.getElementById('simNextBtn').classList.add('hidden');
        }
        function checkSimAnswer(selected, btn) {
            let q = simQuestions[simIndex];
            let feedback = document.getElementById('simFeedback');
            let title = document.getElementById('simFeedbackTitle');
            let text = document.getElementById('simFeedbackText');
            document.querySelectorAll('#simOptions button').forEach(b => b.disabled = true);
            if (selected === q.correct) {
                btn.classList.add('bg-green-100', 'border-green-600');
                title.innerText = '‚úÖ ¬°Correcto!';
                feedback.classList.add('bg-green-50', 'border-green-600', 'text-green-800');
                feedback.classList.remove('bg-red-50', 'border-red-600');
                claimReward(50, 'Respuesta acertada');
            } else {
                btn.classList.add('bg-red-100', 'border-red-600');
                title.innerText = '‚ùå No es correcto';
                feedback.classList.add('bg-red-50', 'border-red-600', 'text-red-800');
                feedback.classList.remove('bg-green-50', 'border-green-600');
            }
            text.innerText = q.explanation;
            feedback.classList.remove('hidden');
            document.getElementById('simNextBtn').classList.remove('hidden');
        }
        function nextSimQuestion() {
            simIndex = (simIndex + 1) % simQuestions.length;
            loadSimQuestion();
        }

        // ---- CHAT TUTOR CON CARGA DE ARCHIVOS ----
        function handleFileUpload(input) {
            let fileList = document.getElementById('fileList');
            let docList = document.getElementById('docList');
            fileList.innerHTML = '';
            Array.from(input.files).forEach(file => {
                let chip = document.createElement('span');
                chip.className = 'bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs flex items-center gap-1';
                chip.innerHTML = `<i class="fas fa-file"></i> ${file.name}`;
                fileList.appendChild(chip);
                // tambi√©n agregar a documentos cargados
                let li = document.createElement('li');
                li.className = 'p-2 bg-blue-50 rounded-lg text-blue-800 flex items-center gap-2';
                li.innerHTML = `<i class="fas fa-file-${file.type.includes('pdf') ? 'pdf' : 'word'}"></i> ${file.name}`;
                docList.appendChild(li);
            });
            // Simular que el bot aprende del archivo
            let chat = document.getElementById('chatMessages');
            chat.innerHTML += `<div class="flex items-start gap-3"><div class="w-9 h-9 rounded-full bg-emerald-600 flex items-center justify-center text-white shrink-0">ü§ñ</div><div class="chat-message-bot p-4 max-w-[80%] text-gray-700">He procesado ${input.files.length} archivo(s). Ahora tengo m√°s contexto sobre normativa y planeamiento.</div></div>`;
            chat.scrollTop = chat.scrollHeight;
        }
        function sendChatMessage() {
            let input = document.getElementById('chatInput');
            let msg = input.value.trim();
            if (!msg) return;
            let chat = document.getElementById('chatMessages');
            // usuario
            chat.innerHTML += `<div class="flex items-start gap-3 justify-end"><div class="chat-message-user p-4 max-w-[80%] text-white">${msg}</div><div class="w-9 h-9 rounded-full bg-blue-600 flex items-center justify-center text-white shrink-0">DR</div></div>`;
            input.value = '';
            chat.scrollTop = chat.scrollHeight;
            // simular respuesta del bot con base en los documentos
            setTimeout(() => {
                let reply = '';
                if (msg.toLowerCase().includes('planeamiento')) reply = 'Seg√∫n los documentos cargados, el planeamiento debe incluir ejes transversales y adecuaciones curriculares. ¬øQuieres un ejemplo?';
                else if (msg.toLowerCase().includes('dua')) reply = 'El DUA sugiere m√∫ltiples formas de representaci√≥n. En el archivo "Lineamientos_evaluacion.docx" se detalla su aplicaci√≥n.';
                else if (msg.toLowerCase().includes('taxonom√≠a bloom')) reply = 'Te comparto un ejemplo: "El estudiante ser√° capaz de dise√±ar un proyecto colaborativo". ¬øNecesitas verbos para indicadores?';
                else reply = 'De acuerdo a la documentaci√≥n del PNFT, te recomiendo revisar el apartado de "Saberes procedimentales". ¬øTe ayudo con algo m√°s espec√≠fico?';
                chat.innerHTML += `<div class="flex items-start gap-3"><div class="w-9 h-9 rounded-full bg-emerald-600 flex items-center justify-center text-white shrink-0">ü§ñ</div><div class="chat-message-bot p-4 max-w-[80%] text-gray-700">${reply}</div></div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 800);
        }

        // Inicializaci√≥n
        loadSimQuestion();
        updateFocusDisplay();
    </script>
</body>
</html>
