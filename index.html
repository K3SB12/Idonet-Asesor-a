<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>üìö SISTEMA INTEGRAL MEP 2026 - ARQUITECTURA COMPLETA (12 PESTA√ëAS)</title>
    <!-- Librer√≠as esenciales -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        /* ==================== SISTEMA DE DISE√ëO INSTITUCIONAL MEP ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, -apple-system, sans-serif;
        }

        :root {
            /* Paleta institucional MEP */
            --mep-verde-profundo: #0B3B2F;
            --mep-verde-claro: #A7C1B0;
            --mep-gris-fondo: #F4F7F5;
            --mep-texto-oscuro: #1E2B28;
            --mep-borde: #C0CFC5;
            --mep-sombra: rgba(11, 59, 47, 0.12);
            --mep-alerta: #D32F2F;
            --mep-exito: #2E7D32;
            --mep-advertencia: #ED6C02;
            --mep-azul: #003366;
            --mep-rojo: #CC0000;
            --mep-acceso: #9b59b6;
            --mep-nosig: #3498db;
            --mep-acs: #e67e22;
            --mep-planeamiento: #2c3e50;
            --mep-diagnostico: #16a085;
            --mep-comunidad: #8e44ad;
            
            /* Modo claro (default) */
            --bg-primary: var(--mep-gris-fondo);
            --bg-sidebar: var(--mep-verde-profundo);
            --text-primary: var(--mep-texto-oscuro);
            --text-sidebar: #FFFFFF;
            --card-bg: #FFFFFF;
            --border-color: var(--mep-borde);
            --button-primary: var(--mep-verde-profundo);
            --button-secondary: var(--mep-verde-claro);
            --hover-overlay: rgba(255, 255, 255, 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1A2A24;
                --bg-sidebar: #0F2A20;
                --text-primary: #E0EDE7;
                --text-sidebar: #FFFFFF;
                --card-bg: #26362F;
                --border-color: #3D5E51;
                --button-primary: #1F5E4F;
                --button-secondary: #3D5E51;
                --hover-overlay: rgba(255, 255, 255, 0.15);
            }
        }

        body {
            display: flex;
            min-height: 100vh;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
        }

        /* ==================== BARRA LATERAL FIJA ==================== */
        .sidebar {
            width: 280px;
            background: var(--bg-sidebar);
            color: var(--text-sidebar);
            padding: 2rem 1rem;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 4px 0 20px var(--mep-sombra);
            z-index: 100;
        }

        .sidebar-header {
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--mep-verde-claro);
            margin-bottom: 1.5rem;
        }

        .sidebar-header h1 {
            font-size: 1.4rem;
            font-weight: 500;
            line-height: 1.4;
        }

        .sidebar-header small {
            font-size: 0.85rem;
            opacity: 0.8;
            display: block;
            margin-top: 0.5rem;
        }

        .nav-btn {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--text-sidebar);
            padding: 1rem 1.2rem;
            text-align: left;
            font-size: 0.95rem;
            border-radius: 12px 0 0 12px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            border-left: 4px solid transparent;
        }

        .nav-btn:hover {
            background: var(--hover-overlay);
        }

        .nav-btn.active {
            background: var(--bg-primary);
            color: var(--mep-verde-profundo);
            border-left: 4px solid var(--mep-verde-claro);
            font-weight: 600;
            box-shadow: -4px 0 10px rgba(0,0,0,0.05);
        }

        /* ==================== CONTENIDO PRINCIPAL ==================== */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 2rem;
            min-height: 100vh;
        }

        /* ==================== PESTA√ëAS ==================== */
        .pestana {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .pestana.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0.5; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ==================== COMPONENTES UI ==================== */
        .card {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 2rem;
            box-shadow: 0 8px 24px var(--mep-sombra);
            border: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--mep-verde-claro);
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--mep-verde-profundo);
        }

        .grid-2, .grid-3, .grid-4 {
            display: grid;
            gap: 1.5rem;
        }

        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-4 { grid-template-columns: repeat(4, 1fr); }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            font-weight: 500;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        input, select, textarea {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 14px;
            padding: 0.8rem 1.2rem;
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: border-color 0.2s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--mep-verde-profundo);
            box-shadow: 0 0 0 3px rgba(11, 59, 47, 0.1);
        }

        .btn {
            background: var(--button-primary);
            color: white;
            border: none;
            border-radius: 40px;
            padding: 0.8rem 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
            border: 1px solid transparent;
        }

        .btn:hover {
            filter: brightness(1.1);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }

        .btn-secondary {
            background: var(--button-secondary);
            color: var(--mep-texto-oscuro);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .btn-acceso { background: var(--mep-acceso); color: white; }
        .btn-nosig { background: var(--mep-nosig); color: white; }
        .btn-acs { background: var(--mep-acs); color: white; }
        .btn-planeamiento { background: var(--mep-planeamiento); color: white; }
        .btn-diagnostico { background: var(--mep-diagnostico); color: white; }
        .btn-comunidad { background: var(--mep-comunidad); color: white; }

        .toolbar {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin: 1.5rem 0;
        }

        /* ==================== TABLAS ==================== */
        .table-container {
            overflow-x: auto;
            border-radius: 16px;
            border: 1px solid var(--border-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card-bg);
        }

        th {
            background: var(--mep-verde-claro);
            color: var(--mep-texto-oscuro);
            font-weight: 600;
            padding: 1rem;
            text-align: left;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        tr:last-child td {
            border-bottom: none;
        }

        /* ==================== BADGES Y ALERTAS ==================== */
        .badge {
            display: inline-block;
            padding: 0.25rem 1rem;
            border-radius: 40px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge-success {
            background: var(--mep-exito);
            color: white;
        }

        .badge-warning {
            background: var(--mep-advertencia);
            color: white;
        }

        .badge-error {
            background: var(--mep-alerta);
            color: white;
        }

        .badge-acceso { background: var(--mep-acceso); color: white; }
        .badge-nosig { background: var(--mep-nosig); color: white; }
        .badge-acs { background: var(--mep-acs); color: white; }

        .alert {
            padding: 1rem 1.5rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
            border-left: 6px solid;
        }

        .alert-warning {
            background: rgba(237, 108, 2, 0.1);
            border-left-color: var(--mep-advertencia);
        }

        .alert-success {
            background: rgba(46, 125, 80, 0.1);
            border-left-color: var(--mep-exito);
        }

        .ayuda-pedagogica {
            background: #e8f4fd;
            border-left: 6px solid #17a2b8;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            font-size: 0.95rem;
        }

        .unidad-card, .foro-mensaje {
            background: #f8f9fa;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
        }

        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 1024px) {
            .grid-4 { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                padding: 1rem;
            }
            
            .main-content {
                margin-left: 0;
                padding: 1.5rem;
            }
            
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .nav-btn {
                border-radius: 12px;
            }
            
            .nav-btn.active {
                border-left: 4px solid var(--mep-verde-claro);
            }
        }
    </style>
</head>
<body>
    <!-- ==================== BARRA LATERAL FIJA CON 12 PESTA√ëAS ==================== -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h1>Sistema Integral<br>Gesti√≥n Docente</h1>
            <small>Ministerio de Educaci√≥n P√∫blica ¬∑ Costa Rica</small>
        </div>
        <nav>
            <button class="nav-btn active" data-pestana="config">üè´ 1. INSTITUCIONES</button>
            <button class="nav-btn" data-pestana="estudiantes">üë• 2. ESTUDIANTES</button>
            <button class="nav-btn" data-pestana="adecuaciones">‚öïÔ∏è 3. ADECUACIONES</button>
            <button class="nav-btn" data-pestana="piad">üìã 4. PIAD</button>
            <button class="nav-btn" data-pestana="conducta">‚öñÔ∏è 5. CONDUCTA</button>
            <button class="nav-btn" data-pestana="asistencia">üìÖ 6. ASISTENCIA</button>
            <button class="nav-btn" data-pestana="cotidiano">üìù 7. COTIDIANO</button>
            <button class="nav-btn" data-pestana="indicadores">üîß 8. INDICADORES</button>
            <button class="nav-btn" data-pestana="reportes">üìë 9. REPORTES</button>
            <button class="nav-btn" data-pestana="planeamiento">üìê 10. PLANEAMIENTO</button>
            <button class="nav-btn" data-pestana="diagnostico">üîç 11. DIAGN√ìSTICO</button>
            <button class="nav-btn" data-pestana="comunidad">üë• 12. COMUNIDAD</button>
        </nav>
    </aside>

    <!-- ==================== CONTENIDO PRINCIPAL ==================== -->
    <main class="main-content" id="contenido-principal"></main>

    <script>
        (function() {
            "use strict";

            // ==================== MODELO DE DATOS CENTRAL ====================
            const ModeloMEP = {
                version: "3.0",
                centros: [],
                configuraciones: [],
                grupos: [],
                estudiantes: [],
                calificaciones: [],
                instrumentos: [],
                asistencia: [],
                bitacora: [],
                periodos: [],
                adecuaciones: [],
                piad: [],
                conducta: [],
                indicadores: [],
                unidades: [],
                minutas: [],
                diagnosticos: [],
                anecdotario: [],
                foro: [],
                recursos: [],
                eventos: []
            };

            // ==================== REPOSITORIO (PERSISTENCIA) ====================
            const Repositorio = {
                KEYS: {
                    CENTROS: 'mep_centros_v3',
                    CONFIG: 'mep_config_v3',
                    GRUPOS: 'mep_grupos_v3',
                    ESTUDIANTES: 'mep_estudiantes_v3',
                    CALIFICACIONES: 'mep_calificaciones_v3',
                    INSTRUMENTOS: 'mep_instrumentos_v3',
                    ASISTENCIA: 'mep_asistencia_v3',
                    BITACORA: 'mep_bitacora_v3',
                    PERIODOS: 'mep_periodos_v3',
                    ADECUACIONES: 'mep_adecuaciones_v3',
                    PIAD: 'mep_piad_v3',
                    CONDUCTA: 'mep_conducta_v3',
                    INDICADORES: 'mep_indicadores_v3',
                    UNIDADES: 'mep_unidades_v3',
                    MINUTAS: 'mep_minutas_v3',
                    DIAGNOSTICOS: 'mep_diagnosticos_v3',
                    ANECDOTARIO: 'mep_anecdotario_v3',
                    FORO: 'mep_foro_v3',
                    RECURSOS: 'mep_recursos_v3',
                    EVENTOS: 'mep_eventos_v3'
                },

                cargarTodo: function() {
                    try {
                        ModeloMEP.centros = JSON.parse(localStorage.getItem(this.KEYS.CENTROS)) || [];
                        ModeloMEP.configuraciones = JSON.parse(localStorage.getItem(this.KEYS.CONFIG)) || [];
                        ModeloMEP.grupos = JSON.parse(localStorage.getItem(this.KEYS.GRUPOS)) || [];
                        ModeloMEP.estudiantes = JSON.parse(localStorage.getItem(this.KEYS.ESTUDIANTES)) || [];
                        ModeloMEP.calificaciones = JSON.parse(localStorage.getItem(this.KEYS.CALIFICACIONES)) || [];
                        ModeloMEP.instrumentos = JSON.parse(localStorage.getItem(this.KEYS.INSTRUMENTOS)) || [];
                        ModeloMEP.asistencia = JSON.parse(localStorage.getItem(this.KEYS.ASISTENCIA)) || [];
                        ModeloMEP.bitacora = JSON.parse(localStorage.getItem(this.KEYS.BITACORA)) || [];
                        ModeloMEP.periodos = JSON.parse(localStorage.getItem(this.KEYS.PERIODOS)) || [];
                        ModeloMEP.adecuaciones = JSON.parse(localStorage.getItem(this.KEYS.ADECUACIONES)) || [];
                        ModeloMEP.piad = JSON.parse(localStorage.getItem(this.KEYS.PIAD)) || [];
                        ModeloMEP.conducta = JSON.parse(localStorage.getItem(this.KEYS.CONDUCTA)) || [];
                        ModeloMEP.indicadores = JSON.parse(localStorage.getItem(this.KEYS.INDICADORES)) || [];
                        ModeloMEP.unidades = JSON.parse(localStorage.getItem(this.KEYS.UNIDADES)) || [];
                        ModeloMEP.minutas = JSON.parse(localStorage.getItem(this.KEYS.MINUTAS)) || [];
                        ModeloMEP.diagnosticos = JSON.parse(localStorage.getItem(this.KEYS.DIAGNOSTICOS)) || [];
                        ModeloMEP.anecdotario = JSON.parse(localStorage.getItem(this.KEYS.ANECDOTARIO)) || [];
                        ModeloMEP.foro = JSON.parse(localStorage.getItem(this.KEYS.FORO)) || [];
                        ModeloMEP.recursos = JSON.parse(localStorage.getItem(this.KEYS.RECURSOS)) || [];
                        ModeloMEP.eventos = JSON.parse(localStorage.getItem(this.KEYS.EVENTOS)) || [];

                        if (ModeloMEP.centros.length === 0) {
                            this.inicializarDatosDemo();
                        }
                    } catch (e) {
                        console.error("Error cargando datos:", e);
                        this.inicializarDatosDemo();
                    }
                },

                inicializarDatosDemo: function() {
                    const centroId = this.generarId();
                    ModeloMEP.centros = [{
                        id: centroId,
                        nombre: 'Liceo Rural Las Moras',
                        direccionRegional: 'Lim√≥n',
                        circuito: '10',
                        codigo: '0255-00',
                        nivel: 'secundaria',
                        leccionesSemanales: 4,
                        registrada: new Date().toLocaleDateString('es-CR')
                    }];

                    ModeloMEP.estudiantes = [
                        { id: this.generarId(), institucionId: centroId, identificacion: '1-1234-5678', nombre: 'Alberto Laureano Guevara', seccion: '9-1', telefono1: '88881111', telefono2: '88881112', correoEncargado: 'padre1@gmail.com' },
                        { id: this.generarId(), institucionId: centroId, identificacion: '2-2345-6789', nombre: 'Mar√≠a Jos√© Jim√©nez', seccion: '9-1', telefono1: '88882222', telefono2: '88882223', correoEncargado: 'madre2@gmail.com' },
                        { id: this.generarId(), institucionId: centroId, identificacion: '3-3456-7890', nombre: 'Leonardo Reynoso', seccion: '9-1', telefono1: '88883333', telefono2: '88883334', correoEncargado: 'padre3@gmail.com' }
                    ];

                    ModeloMEP.indicadores = [
                        { id: this.generarId(), institucionId: centroId, letra: 'A', descripcion: 'Acent√∫a correctamente las palabras en la producci√≥n escrita', puntos: 3 },
                        { id: this.generarId(), institucionId: centroId, letra: 'B', descripcion: 'Identifica ideas principales en textos expositivos', puntos: 3 },
                        { id: this.generarId(), institucionId: centroId, letra: 'C', descripcion: 'Utiliza vocabulario acorde al nivel en sus intervenciones', puntos: 3 }
                    ];

                    this.guardarTodo();
                },

                guardarTodo: function() {
                    localStorage.setItem(this.KEYS.CENTROS, JSON.stringify(ModeloMEP.centros));
                    localStorage.setItem(this.KEYS.CONFIG, JSON.stringify(ModeloMEP.configuraciones));
                    localStorage.setItem(this.KEYS.GRUPOS, JSON.stringify(ModeloMEP.grupos));
                    localStorage.setItem(this.KEYS.ESTUDIANTES, JSON.stringify(ModeloMEP.estudiantes));
                    localStorage.setItem(this.KEYS.CALIFICACIONES, JSON.stringify(ModeloMEP.calificaciones));
                    localStorage.setItem(this.KEYS.INSTRUMENTOS, JSON.stringify(ModeloMEP.instrumentos));
                    localStorage.setItem(this.KEYS.ASISTENCIA, JSON.stringify(ModeloMEP.asistencia));
                    localStorage.setItem(this.KEYS.BITACORA, JSON.stringify(ModeloMEP.bitacora));
                    localStorage.setItem(this.KEYS.PERIODOS, JSON.stringify(ModeloMEP.periodos));
                    localStorage.setItem(this.KEYS.ADECUACIONES, JSON.stringify(ModeloMEP.adecuaciones));
                    localStorage.setItem(this.KEYS.PIAD, JSON.stringify(ModeloMEP.piad));
                    localStorage.setItem(this.KEYS.CONDUCTA, JSON.stringify(ModeloMEP.conducta));
                    localStorage.setItem(this.KEYS.INDICADORES, JSON.stringify(ModeloMEP.indicadores));
                    localStorage.setItem(this.KEYS.UNIDADES, JSON.stringify(ModeloMEP.unidades));
                    localStorage.setItem(this.KEYS.MINUTAS, JSON.stringify(ModeloMEP.minutas));
                    localStorage.setItem(this.KEYS.DIAGNOSTICOS, JSON.stringify(ModeloMEP.diagnosticos));
                    localStorage.setItem(this.KEYS.ANECDOTARIO, JSON.stringify(ModeloMEP.anecdotario));
                    localStorage.setItem(this.KEYS.FORO, JSON.stringify(ModeloMEP.foro));
                    localStorage.setItem(this.KEYS.RECURSOS, JSON.stringify(ModeloMEP.recursos));
                    localStorage.setItem(this.KEYS.EVENTOS, JSON.stringify(ModeloMEP.eventos));
                },

                generarId: function() {
                    return Date.now().toString(36) + Math.random().toString(36).substr(2);
                },

                getEstudiantesPorInstitucion: function(institucionId) {
                    return ModeloMEP.estudiantes.filter(e => e.institucionId === institucionId);
                }
            };

            // ==================== MOTOR DE C√ÅLCULO ====================
            const MotorCalculo = {
                validarPorcentajes: function(tc, proy, pru, tar) {
                    const suma = (tc || 0) + (proy || 0) + (pru || 0) + (tar || 0);
                    return suma === 100;
                },

                calcularPromedio: function(notas, porcentajes) {
                    if (Object.values(notas).some(n => n === null || n === undefined || n === '')) {
                        throw new Error('Todas las notas son requeridas');
                    }
                    return (
                        (parseFloat(notas.trabajoCotidiano) * porcentajes.trabajoCotidiano / 100) +
                        (parseFloat(notas.proyecto) * porcentajes.proyecto / 100) +
                        (parseFloat(notas.prueba) * porcentajes.prueba / 100) +
                        (parseFloat(notas.tareas) * porcentajes.tareas / 100)
                    ).toFixed(2);
                },

                calcularNotaConducta: function(estudianteId) {
                    const faltas = ModeloMEP.conducta.filter(c => c.estudianteId === estudianteId);
                    const totalDescontado = faltas.reduce((sum, f) => sum + f.puntosDescontar, 0);
                    return Math.max(100 - totalDescontado, 50);
                },

                determinarEstado: function(promedio) {
                    const p = parseFloat(promedio);
                    if (p >= 65) return 'APROBADO';
                    if (p >= 50) return 'CONVOCATORIA';
                    return 'REPROBADO';
                }
            };

            // ==================== VALIDADOR ====================
            const Validador = {
                email: function(email) {
                    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
                },

                telefono: function(tel) {
                    return /^[0-9+\-\s]{8,}$/.test(tel);
                },

                antesDeCerrarPeriodo: function(grupoId, periodo, a√±o) {
                    const estudiantes = ModeloMEP.estudiantes.filter(e => e.seccion === grupoId);
                    const pendientes = estudiantes.filter(est => {
                        const cal = ModeloMEP.calificaciones.find(c => 
                            c.estudianteId === est.id && c.periodo === periodo && c.a√±o === a√±o
                        );
                        return !cal || Object.values(cal.notas || {}).some(n => n === null);
                    });
                    return pendientes.length === 0;
                }
            };

            // ==================== CONTROLADOR DE UI ====================
            const UI = {
                pestanaActual: 'config',
                institucionActiva: null,

                init: function() {
                    Repositorio.cargarTodo();
                    if (ModeloMEP.centros.length > 0) {
                        this.institucionActiva = ModeloMEP.centros[0];
                    }
                    this.configurarNavegacion();
                    this.cambiarPestana('config');
                },

                configurarNavegacion: function() {
                    document.querySelectorAll('.nav-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            const pestana = e.currentTarget.dataset.pestana;
                            this.cambiarPestana(pestana);
                        });
                    });
                },

                cambiarPestana: function(pestanaId) {
                    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                    document.querySelector(`.nav-btn[data-pestana="${pestanaId}"]`).classList.add('active');
                    
                    const container = document.getElementById('contenido-principal');
                    
                    switch(pestanaId) {
                        case 'config': this.renderConfiguracion(container); break;
                        case 'estudiantes': this.renderEstudiantes(container); break;
                        case 'adecuaciones': this.renderAdecuaciones(container); break;
                        case 'piad': this.renderPIAD(container); break;
                        case 'conducta': this.renderConducta(container); break;
                        case 'asistencia': this.renderAsistencia(container); break;
                        case 'cotidiano': this.renderCotidiano(container); break;
                        case 'indicadores': this.renderIndicadores(container); break;
                        case 'reportes': this.renderReportes(container); break;
                        case 'planeamiento': this.renderPlaneamiento(container); break;
                        case 'diagnostico': this.renderDiagnostico(container); break;
                        case 'comunidad': this.renderComunidad(container); break;
                    }
                },

                // ==================== PESTA√ëA 1: INSTITUCIONES ====================
                renderConfiguracion: function(container) {
                    let html = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üè´ Centros Educativos</h2>
                            </div>
                            
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Nombre de la Instituci√≥n</label>
                                    <input type="text" id="inst-nombre" placeholder="Ej: Liceo Rural Las Moras">
                                </div>
                                <div class="form-group">
                                    <label>Direcci√≥n Regional</label>
                                    <input type="text" id="inst-regional" placeholder="Ej: Lim√≥n">
                                </div>
                            </div>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Circuito Escolar</label>
                                    <input type="text" id="inst-circuito" placeholder="Ej: 10">
                                </div>
                                <div class="form-group">
                                    <label>C√≥digo</label>
                                    <input type="text" id="inst-codigo" placeholder="Ej: 0255-00">
                                </div>
                            </div>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Nivel</label>
                                    <select id="inst-nivel">
                                        <option value="preescolar">Preescolar</option>
                                        <option value="primaria">Primaria</option>
                                        <option value="secundaria" selected>Secundaria</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Lecciones semanales</label>
                                    <input type="number" id="inst-lecciones" value="4" min="1" max="8">
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="UI.agregarInstitucion()">‚ûï Agregar Instituci√≥n</button>
                        </div>

                        <div class="card">
                            <h3>Instituciones Registradas</h3>
                            <div id="instituciones-lista"></div>
                        </div>
                    `;

                    container.innerHTML = html;
                    this.cargarInstituciones();
                },

                cargarInstituciones: function() {
                    const lista = document.getElementById('instituciones-lista');
                    lista.innerHTML = ModeloMEP.centros.map(c => `
                        <div class="unidad-card" onclick="UI.seleccionarInstitucion('${c.id}')">
                            <h4>${c.nombre}</h4>
                            <p>${c.direccionRegional} ¬∑ Circuito: ${c.circuito} ¬∑ C√≥digo: ${c.codigo}</p>
                            <p>Nivel: ${c.nivel} ¬∑ ${c.leccionesSemanales} lec/sem</p>
                            <button class="btn btn-outline btn-small" onclick="event.stopPropagation(); UI.editarInstitucion('${c.id}')">‚úèÔ∏è</button>
                            <button class="btn btn-danger btn-small" onclick="event.stopPropagation(); UI.eliminarInstitucion('${c.id}')">üóëÔ∏è</button>
                        </div>
                    `).join('');
                },

                agregarInstitucion: function() {
                    const nombre = document.getElementById('inst-nombre').value;
                    if (!nombre) return alert('‚ùå Nombre requerido');

                    ModeloMEP.centros.push({
                        id: Repositorio.generarId(),
                        nombre,
                        direccionRegional: document.getElementById('inst-regional').value,
                        circuito: document.getElementById('inst-circuito').value,
                        codigo: document.getElementById('inst-codigo').value,
                        nivel: document.getElementById('inst-nivel').value,
                        leccionesSemanales: parseInt(document.getElementById('inst-lecciones').value) || 4,
                        registrada: new Date().toLocaleDateString('es-CR')
                    });

                    Repositorio.guardarTodo();
                    this.cargarInstituciones();
                    alert('‚úÖ Instituci√≥n agregada');
                },

                seleccionarInstitucion: function(id) {
                    this.institucionActiva = ModeloMEP.centros.find(c => c.id === id);
                    alert(`‚úÖ Instituci√≥n seleccionada: ${this.institucionActiva.nombre}`);
                },

                eliminarInstitucion: function(id) {
                    if (confirm('¬øEliminar esta instituci√≥n?')) {
                        ModeloMEP.centros = ModeloMEP.centros.filter(c => c.id !== id);
                        Repositorio.guardarTodo();
                        this.cargarInstituciones();
                    }
                },

                // ==================== PESTA√ëA 2: ESTUDIANTES ====================
                renderEstudiantes: function(container) {
                    let html = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üë• Gesti√≥n de Estudiantes</h2>
                            </div>
                            
                            <details>
                                <summary style="cursor: pointer; margin-bottom:15px;">‚ûï Agregar Estudiante</summary>
                                <div class="grid-2">
                                    <input type="text" id="est-identificacion" placeholder="C√©dula">
                                    <input type="text" id="est-nombre" placeholder="Nombre completo">
                                </div>
                                <div class="grid-2">
                                    <input type="text" id="est-seccion" placeholder="Secci√≥n">
                                    <input type="email" id="est-correoMEP" placeholder="Correo MEP">
                                </div>
                                <div class="grid-2">
                                    <input type="text" id="est-tel1" placeholder="Tel√©fono 1">
                                    <input type="text" id="est-tel2" placeholder="Tel√©fono 2">
                                </div>
                                <input type="email" id="est-correoEnc" placeholder="Correo del encargado">
                                <button class="btn btn-success" onclick="UI.agregarEstudiante()">‚úÖ Guardar</button>
                            </details>

                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Identificaci√≥n</th>
                                            <th>Nombre</th>
                                            <th>Secci√≥n</th>
                                            <th>Tel√©fonos</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="estudiantes-tbody"></tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    container.innerHTML = html;
                    this.cargarEstudiantes();
                },

                cargarEstudiantes: function() {
                    const tbody = document.getElementById('estudiantes-tbody');
                    if (!tbody) return;
                    
                    const estudiantes = this.institucionActiva ? 
                        ModeloMEP.estudiantes.filter(e => e.institucionId === this.institucionActiva.id) : 
                        ModeloMEP.estudiantes;

                    tbody.innerHTML = estudiantes.map(e => `
                        <tr>
                            <td>${e.identificacion}</td>
                            <td>${e.nombre}</td>
                            <td>${e.seccion}</td>
                            <td>${e.telefono1} / ${e.telefono2}</td>
                            <td>
                                <button class="btn btn-outline btn-small" onclick="UI.editarEstudiante('${e.id}')">‚úèÔ∏è</button>
                                <button class="btn btn-danger btn-small" onclick="UI.eliminarEstudiante('${e.id}')">üóëÔ∏è</button>
                            </td>
                        </tr>
                    `).join('');
                },

                agregarEstudiante: function() {
                    if (!this.institucionActiva) {
                        alert('‚ùå Seleccione una instituci√≥n primero');
                        return;
                    }

                    const estudiante = {
                        id: Repositorio.generarId(),
                        institucionId: this.institucionActiva.id,
                        identificacion: document.getElementById('est-identificacion').value,
                        nombre: document.getElementById('est-nombre').value,
                        seccion: document.getElementById('est-seccion').value,
                        correoMEP: document.getElementById('est-correoMEP').value,
                        telefono1: document.getElementById('est-tel1').value,
                        telefono2: document.getElementById('est-tel2').value,
                        correoEncargado: document.getElementById('est-correoEnc').value
                    };

                    if (!estudiante.identificacion || !estudiante.nombre) {
                        alert('‚ùå Identificaci√≥n y nombre obligatorios');
                        return;
                    }

                    ModeloMEP.estudiantes.push(estudiante);
                    Repositorio.guardarTodo();
                    this.cargarEstudiantes();
                    alert('‚úÖ Estudiante agregado');
                },

                eliminarEstudiante: function(id) {
                    if (confirm('¬øEliminar este estudiante?')) {
                        ModeloMEP.estudiantes = ModeloMEP.estudiantes.filter(e => e.id !== id);
                        Repositorio.guardarTodo();
                        this.cargarEstudiantes();
                    }
                },

                // ==================== PESTA√ëA 3: ADECUACIONES ====================
                renderAdecuaciones: function(container) {
                    const estudiantes = this.institucionActiva ? 
                        ModeloMEP.estudiantes.filter(e => e.institucionId === this.institucionActiva.id) : [];

                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">‚öïÔ∏è Adecuaciones Curriculares</h2>
                            </div>
                            
                            <div class="ayuda-pedagogica">
                                <h3>üìò Tipos de Adecuaci√≥n seg√∫n MEP</h3>
                                <p><span class="badge badge-acceso">Acceso</span> Recursos especiales, materiales, comunicaci√≥n</p>
                                <p><span class="badge badge-nosig">No significativa</span> Metodolog√≠a, tiempos, t√©cnicas de evaluaci√≥n</p>
                                <p><span class="badge badge-acs">Significativa (ACS)</span> Elimina contenidos esenciales, requiere dictamen</p>
                            </div>

                            <div class="grid-3">
                                <select id="adec-estudiante">
                                    <option value="">Seleccione estudiante...</option>
                                    ${estudiantes.map(e => `<option value="${e.id}">${e.nombre}</option>`).join('')}
                                </select>
                                <select id="adec-tipo">
                                    <option value="acceso">Acceso</option>
                                    <option value="nosignificativa">No significativa</option>
                                    <option value="acs">Significativa (ACS)</option>
                                </select>
                                <button class="btn btn-success" onclick="UI.agregarAdecuacion()">‚ûï Agregar</button>
                            </div>

                            <div id="adecuaciones-lista" class="mt-3"></div>
                        </div>
                    `;
                    this.cargarAdecuaciones();
                },

                cargarAdecuaciones: function() {
                    const lista = document.getElementById('adecuaciones-lista');
                    const adecuaciones = ModeloMEP.adecuaciones;
                    
                    lista.innerHTML = adecuaciones.map(a => {
                        const estudiante = ModeloMEP.estudiantes.find(e => e.id === a.estudianteId);
                        const badgeClass = a.tipo === 'acceso' ? 'badge-acceso' : a.tipo === 'nosignificativa' ? 'badge-nosig' : 'badge-acs';
                        return `
                            <div class="unidad-card">
                                <p><strong>${estudiante?.nombre}</strong> <span class="badge ${badgeClass}">${a.tipo}</span></p>
                                <p>${a.descripcion}</p>
                                <p><small>Responsable: ${a.responsable} ¬∑ Dictamen: ${a.dictamen}</small></p>
                                <button class="btn btn-outline btn-small" onclick="UI.editarAdecuacion('${a.id}')">‚úèÔ∏è</button>
                                <button class="btn btn-danger btn-small" onclick="UI.eliminarAdecuacion('${a.id}')">üóëÔ∏è</button>
                            </div>
                        `;
                    }).join('') || '<p>No hay adecuaciones registradas</p>';
                },

                agregarAdecuacion: function() {
                    const estudianteId = document.getElementById('adec-estudiante')?.value;
                    const tipo = document.getElementById('adec-tipo')?.value;
                    
                    if (!estudianteId) return alert('Seleccione un estudiante');

                    const descripcion = prompt(`Describa la adecuaci√≥n de ${tipo}:`);
                    if (!descripcion) return;

                    ModeloMEP.adecuaciones.push({
                        id: Repositorio.generarId(),
                        estudianteId,
                        tipo,
                        descripcion,
                        fechaRegistro: new Date().toISOString().split('T')[0],
                        responsable: tipo === 'acceso' ? 'Padres/Junta/Docente' : tipo === 'nosignificativa' ? 'Docente' : 'Comit√© de Apoyo',
                        dictamen: tipo === 'acs' ? 'Pendiente' : 'No aplica'
                    });

                    Repositorio.guardarTodo();
                    this.cargarAdecuaciones();
                },

                eliminarAdecuacion: function(id) {
                    if (confirm('¬øEliminar esta adecuaci√≥n?')) {
                        ModeloMEP.adecuaciones = ModeloMEP.adecuaciones.filter(a => a.id !== id);
                        Repositorio.guardarTodo();
                        this.cargarAdecuaciones();
                    }
                },

                // ==================== PESTA√ëA 4: PIAD ====================
                renderPIAD: function(container) {
                    const estudiantes = this.institucionActiva ? 
                        ModeloMEP.estudiantes.filter(e => e.institucionId === this.institucionActiva.id) : [];

                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üìã Plan Individual de Adecuaci√≥n (PIAD)</h2>
                            </div>
                            
                            <div class="grid-2">
                                <select id="piad-estudiante">
                                    <option value="">Seleccione estudiante...</option>
                                    ${estudiantes.map(e => `<option value="${e.id}">${e.nombre}</option>`).join('')}
                                </select>
                                <button class="btn btn-planeamiento" onclick="UI.generarPIAD()">üìÑ Generar PIAD</button>
                            </div>

                            <div id="piad-lista" class="mt-3"></div>
                        </div>
                    `;
                    this.cargarPIAD();
                },

                cargarPIAD: function() {
                    const lista = document.getElementById('piad-lista');
                    const piads = ModeloMEP.piad;
                    
                    lista.innerHTML = piads.map(p => {
                        const estudiante = ModeloMEP.estudiantes.find(e => e.id === p.estudianteId);
                        return `
                            <div class="card">
                                <h4>PIAD - ${estudiante?.nombre}</h4>
                                <p>Fecha: ${p.fechaElaboracion} ¬∑ Comit√©: ${p.comiteAprobacion} ¬∑ Dictamen: ${p.dictamen}</p>
                                <p>Adecuaciones: ${p.adecuacionesAplicadas}</p>
                                <p>Seguimiento: ${p.seguimiento} ¬∑ Vigencia: ${p.vigencia}</p>
                                <button class="btn btn-outline btn-small" onclick="UI.editarPIAD('${p.id}')">‚úèÔ∏è</button>
                                <button class="btn btn-danger btn-small" onclick="UI.eliminarPIAD('${p.id}')">üóëÔ∏è</button>
                            </div>
                        `;
                    }).join('') || '<p>No hay PIAD generados</p>';
                },

                generarPIAD: function() {
                    const estudianteId = document.getElementById('piad-estudiante')?.value;
                    if (!estudianteId) return alert('Seleccione un estudiante');

                    const fecha = prompt('Fecha de elaboraci√≥n (YYYY-MM-DD):', new Date().toISOString().split('T')[0]);
                    if (!fecha) return;

                    const comite = prompt('Comit√© de Apoyo:', 'Comit√© de Apoyo Educativo');
                    const dictamen = prompt('Dictamen:', 'Aprobado');
                    const adecuaciones = prompt('Adecuaciones aplicadas:');
                    const seguimiento = prompt('Plan de seguimiento:');
                    const vigencia = prompt('Vigencia:', '2025-2026');

                    ModeloMEP.piad.push({
                        id: Repositorio.generarId(),
                        estudianteId,
                        fechaElaboracion: fecha,
                        comiteAprobacion: comite,
                        dictamen,
                        adecuacionesAplicadas: adecuaciones,
                        seguimiento,
                        vigencia
                    });

                    Repositorio.guardarTodo();
                    this.cargarPIAD();
                },

                eliminarPIAD: function(id) {
                    if (confirm('¬øEliminar este PIAD?')) {
                        ModeloMEP.piad = ModeloMEP.piad.filter(p => p.id !== id);
                        Repositorio.guardarTodo();
                        this.cargarPIAD();
                    }
                },

                // ==================== PESTA√ëA 5: CONDUCTA (REAC 2026) ====================
                renderConducta: function(container) {
                    const estudiantes = this.institucionActiva ? 
                        ModeloMEP.estudiantes.filter(e => e.institucionId === this.institucionActiva.id) : [];

                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">‚öñÔ∏è Evaluaci√≥n de la Conducta (REAC 2026)</h2>
                            </div>
                            
                            <div class="ayuda-pedagogica">
                                <h3>üìò Nuevo Reglamento de Conducta 2026</h3>
                                <p>Nota inicial: 100 ¬∑ Aprobaci√≥n: 65 (Primaria) / 70 (Secundaria) ¬∑ P√©rdida m√°xima: 50 pts</p>
                            </div>

                            <div class="grid-3">
                                <select id="cond-estudiante">
                                    ${estudiantes.map(e => `<option value="${e.id}">${e.nombre}</option>`).join('')}
                                </select>
                                <select id="cond-tipo" onchange="UI.actualizarRangoPuntos()">
                                    <option value="muyLeve">Muy leve (1-5 pts)</option>
                                    <option value="leve">Leve (5-15 pts)</option>
                                    <option value="grave">Grave (20 pts)</option>
                                    <option value="muyGrave">Muy grave (35 pts)</option>
                                </select>
                                <input type="number" id="cond-puntos" min="1" max="5" value="1">
                            </div>
                            <div class="grid-2">
                                <input type="date" id="cond-fecha" value="${new Date().toISOString().split('T')[0]}">
                                <input type="text" id="cond-descripcion" placeholder="Descripci√≥n de la falta">
                            </div>
                            <button class="btn btn-warning" onclick="UI.registrarFalta()">‚ö†Ô∏è Registrar Falta</button>

                            <div class="table-container mt-3">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Estudiante</th>
                                            <th>Tipo</th>
                                            <th>Puntos</th>
                                            <th>Nota</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="conducta-tbody"></tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    this.cargarConducta();
                },

                cargarConducta: function() {
                    const tbody = document.getElementById('conducta-tbody');
                    if (!tbody) return;

                    tbody.innerHTML = ModeloMEP.conducta.map(c => {
                        const estudiante = ModeloMEP.estudiantes.find(e => e.id === c.estudianteId);
                        return `
                            <tr>
                                <td>${c.fecha}</td>
                                <td>${estudiante?.nombre}</td>
                                <td>${c.tipo}</td>
                                <td>-${c.puntosDescontar}</td>
                                <td>${c.notaResultante}</td>
                                <td>
                                    <button class="btn btn-danger btn-small" onclick="UI.eliminarFalta('${c.id}')">üóëÔ∏è</button>
                                </td>
                            </tr>
                        `;
                    }).join('');
                },

                actualizarRangoPuntos: function() {
                    const tipo = document.getElementById('cond-tipo').value;
                    const input = document.getElementById('cond-puntos');
                    const rangos = {
                        muyLeve: { min: 1, max: 5, valor: 1 },
                        leve: { min: 5, max: 15, valor: 5 },
                        grave: { min: 20, max: 20, valor: 20 },
                        muyGrave: { min: 35, max: 35, valor: 35 }
                    };
                    input.min = rangos[tipo].min;
                    input.max = rangos[tipo].max;
                    input.value = rangos[tipo].valor;
                },

                registrarFalta: function() {
                    const estudianteId = document.getElementById('cond-estudiante').value;
                    const puntos = parseInt(document.getElementById('cond-puntos').value);
                    const fecha = document.getElementById('cond-fecha').value;
                    const descripcion = document.getElementById('cond-descripcion').value;
                    const tipo = document.getElementById('cond-tipo').value;

                    if (!descripcion) return alert('Descripci√≥n requerida');

                    const faltasEstudiante = ModeloMEP.conducta.filter(c => c.estudianteId === estudianteId);
                    const totalDescontado = faltasEstudiante.reduce((sum, f) => sum + f.puntosDescontar, 0);
                    const notaResultante = Math.max(100 - totalDescontado - puntos, 50);

                    ModeloMEP.conducta.push({
                        id: Repositorio.generarId(),
                        estudianteId,
                        fecha,
                        tipo,
                        puntosDescontar: puntos,
                        descripcion,
                        notaResultante
                    });

                    Repositorio.guardarTodo();
                    this.cargarConducta();
                    alert(`‚úÖ Falta registrada. Nueva nota: ${notaResultante}`);
                },

                eliminarFalta: function(id) {
                    if (confirm('¬øEliminar este registro?')) {
                        ModeloMEP.conducta = ModeloMEP.conducta.filter(c => c.id !== id);
                        Repositorio.guardarTodo();
                        this.cargarConducta();
                    }
                },

                // ==================== PESTA√ëA 6: ASISTENCIA ====================
                renderAsistencia: function(container) {
                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üìÖ Control de Asistencia</h2>
                            </div>
                            <div class="grid-3">
                                <input type="date" id="asis-fecha" value="${new Date().toISOString().split('T')[0]}">
                                <input type="text" id="asis-seccion" placeholder="Secci√≥n">
                                <button class="btn btn-primary" onclick="UI.cargarAsistencia()">üìÖ Cargar Lista</button>
                            </div>
                            <div id="asis-tabla" class="table-container mt-3"></div>
                            <button class="btn btn-success mt-3" onclick="UI.guardarAsistencia()">üíæ Guardar</button>
                        </div>
                    `;
                },

                cargarAsistencia: function() {
                    const fecha = document.getElementById('asis-fecha').value;
                    const seccion = document.getElementById('asis-seccion').value;
                    
                    const estudiantes = this.institucionActiva ? 
                        ModeloMEP.estudiantes.filter(e => e.institucionId === this.institucionActiva.id && (!seccion || e.seccion === seccion)) : [];

                    let html = '<table><tr><th>Estudiante</th><th>Estado</th></tr>';
                    estudiantes.forEach(e => {
                        html += `<tr>
                            <td>${e.nombre}</td>
                            <td>
                                <select id="asis-${e.id}">
                                    <option value="P">Presente</option>
                                    <option value="AJ">Ausencia Justificada</option>
                                    <option value="AI">Ausencia Injustificada</option>
                                    <option value="T">Tarde</option>
                                </select>
                            </td>
                        </tr>`;
                    });
                    html += '</table>';
                    document.getElementById('asis-tabla').innerHTML = html;
                },

                guardarAsistencia: function() {
                    alert('‚úÖ Asistencia guardada (simulado)');
                },

                // ==================== PESTA√ëA 7: COTIDIANO ====================
                renderCotidiano: function(container) {
                    const estudiantes = this.institucionActiva ? 
                        ModeloMEP.estudiantes.filter(e => e.institucionId === this.institucionActiva.id) : [];
                    const indicadores = ModeloMEP.indicadores.filter(i => i.institucionId === this.institucionActiva?.id);

                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üìù Trabajo Cotidiano</h2>
                            </div>
                            
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Estudiante</th>
                                            ${indicadores.map(i => `<th>${i.letra}</th>`).join('')}
                                            <th>Total</th>
                                            <th>%</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${estudiantes.map(e => `
                                            <tr>
                                                <td>${e.nombre}</td>
                                                ${indicadores.map(i => `
                                                    <td><input type="number" value="3" min="0" max="3" style="width:60px;" class="nota-${e.id}-${i.id}"></td>
                                                `).join('')}
                                                <td class="total-${e.id}">9</td>
                                                <td class="porcentaje-${e.id}">50%</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                            <button class="btn btn-success mt-3" onclick="UI.guardarCotidiano()">üíæ Guardar</button>
                        </div>
                    `;
                },

                guardarCotidiano: function() {
                    alert('‚úÖ Evaluaciones guardadas');
                },

                // ==================== PESTA√ëA 8: INDICADORES ====================
                renderIndicadores: function(container) {
                    const indicadores = ModeloMEP.indicadores.filter(i => i.institucionId === this.institucionActiva?.id);

                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üîß Gesti√≥n de Indicadores</h2>
                            </div>
                            
                            <div class="grid-3">
                                <input type="text" id="ind-letra" placeholder="Letra (A, B, C)" maxlength="1">
                                <input type="text" id="ind-descripcion" placeholder="Descripci√≥n">
                                <input type="number" id="ind-puntos" value="3" min="1" max="5">
                            </div>
                            <button class="btn btn-success" onclick="UI.agregarIndicador()">‚ûï Agregar</button>

                            <div class="table-container mt-3">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Letra</th>
                                            <th>Descripci√≥n</th>
                                            <th>Puntos</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${indicadores.map(i => `
                                            <tr>
                                                <td><strong>${i.letra}</strong></td>
                                                <td>${i.descripcion}</td>
                                                <td>${i.puntos}</td>
                                                <td>
                                                    <button class="btn btn-outline btn-small" onclick="UI.editarIndicador('${i.id}')">‚úèÔ∏è</button>
                                                    <button class="btn btn-danger btn-small" onclick="UI.eliminarIndicador('${i.id}')">üóëÔ∏è</button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                },

                agregarIndicador: function() {
                    const letra = document.getElementById('ind-letra').value.toUpperCase();
                    const descripcion = document.getElementById('ind-descripcion').value;
                    const puntos = parseInt(document.getElementById('ind-puntos').value);

                    if (!letra || !descripcion) return alert('Letra y descripci√≥n requeridas');

                    ModeloMEP.indicadores.push({
                        id: Repositorio.generarId(),
                        institucionId: this.institucionActiva.id,
                        letra,
                        descripcion,
                        puntos
                    });

                    Repositorio.guardarTodo();
                    this.cambiarPestana('indicadores');
                },

                eliminarIndicador: function(id) {
                    if (confirm('¬øEliminar este indicador?')) {
                        ModeloMEP.indicadores = ModeloMEP.indicadores.filter(i => i.id !== id);
                        Repositorio.guardarTodo();
                        this.cambiarPestana('indicadores');
                    }
                },

                // ==================== PESTA√ëA 9: REPORTES ====================
                renderReportes: function(container) {
                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üìë Reportes Oficiales MEP</h2>
                            </div>
                            
                            <div class="grid-3">
                                <button class="btn btn-primary" onclick="UI.generarReporte('acta')">üìú Acta Final</button>
                                <button class="btn btn-warning" onclick="UI.generarReporte('conducta')">‚öñÔ∏è Conducta</button>
                                <button class="btn btn-info" onclick="UI.generarReporte('piad')">üìã PIAD</button>
                                <button class="btn btn-success" onclick="UI.generarReporte('asistencia')">üìÖ Asistencia</button>
                                <button class="btn btn-outline" onclick="UI.generarReporte('notas')">üìä Notas</button>
                            </div>
                        </div>
                    `;
                },

                generarReporte: function(tipo) {
                    alert(`Generando reporte de ${tipo}...`);
                },

                // ==================== PESTA√ëA 10: PLANEAMIENTO ====================
                renderPlaneamiento: function(container) {
                    const unidades = ModeloMEP.unidades.filter(u => u.institucionId === this.institucionActiva?.id);

                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üìê Planeamiento Did√°ctico</h2>
                            </div>
                            
                            <div class="ayuda-pedagogica">
                                <p>15-20 horas semanales dedican los docentes al planeamiento seg√∫n el MEP.</p>
                            </div>

                            <button class="btn btn-planeamiento" onclick="UI.mostrarFormUnidad()">‚ûï Nueva Unidad</button>

                            <div id="unidades-lista" class="mt-3">
                                ${unidades.map(u => `
                                    <div class="unidad-card">
                                        <h4>${u.titulo}</h4>
                                        <p>${u.fechaInicio} al ${u.fechaFin} ¬∑ ${u.asignatura}</p>
                                        <p><small>Objetivos: ${u.objetivos?.substring(0,100)}...</small></p>
                                        <button class="btn btn-outline btn-small" onclick="UI.editarUnidad('${u.id}')">‚úèÔ∏è</button>
                                        <button class="btn btn-danger btn-small" onclick="UI.eliminarUnidad('${u.id}')">üóëÔ∏è</button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                },

                mostrarFormUnidad: function() {
                    const titulo = prompt('T√≠tulo de la unidad:');
                    if (!titulo) return;

                    const fechaInicio = prompt('Fecha inicio (YYYY-MM-DD):', new Date().toISOString().split('T')[0]);
                    const fechaFin = prompt('Fecha fin (YYYY-MM-DD):');
                    
                    ModeloMEP.unidades.push({
                        id: Repositorio.generarId(),
                        institucionId: this.institucionActiva.id,
                        titulo,
                        fechaInicio,
                        fechaFin,
                        asignatura: 'Espa√±ol',
                        objetivos: prompt('Objetivos:'),
                        contenidos: prompt('Contenidos:')
                    });

                    Repositorio.guardarTodo();
                    this.cambiarPestana('planeamiento');
                },

                eliminarUnidad: function(id) {
                    if (confirm('¬øEliminar esta unidad?')) {
                        ModeloMEP.unidades = ModeloMEP.unidades.filter(u => u.id !== id);
                        Repositorio.guardarTodo();
                        this.cambiarPestana('planeamiento');
                    }
                },

                // ==================== PESTA√ëA 11: DIAGN√ìSTICO ====================
                renderDiagnostico: function(container) {
                    const estudiantes = this.institucionActiva ? 
                        ModeloMEP.estudiantes.filter(e => e.institucionId === this.institucionActiva.id) : [];

                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üîç Evaluaci√≥n Diagn√≥stica</h2>
                            </div>
                            
                            <div class="grid-2">
                                <select id="diag-estudiante">
                                    ${estudiantes.map(e => `<option value="${e.id}">${e.nombre}</option>`).join('')}
                                </select>
                                <button class="btn btn-diagnostico" onclick="UI.nuevoDiagnostico()">üìã Nuevo Diagn√≥stico</button>
                            </div>

                            <div id="diagnosticos-lista" class="mt-3"></div>
                        </div>
                    `;
                    this.cargarDiagnosticos();
                },

                cargarDiagnosticos: function() {
                    const lista = document.getElementById('diagnosticos-lista');
                    const diagnosticos = ModeloMEP.diagnosticos;
                    
                    lista.innerHTML = diagnosticos.map(d => {
                        const estudiante = ModeloMEP.estudiantes.find(e => e.id === d.estudianteId);
                        return `
                            <div class="unidad-card">
                                <p><strong>${estudiante?.nombre}</strong> ¬∑ ${d.fecha}</p>
                                <p>${d.areaCognoscitiva}</p>
                                <button class="btn btn-danger btn-small" onclick="UI.eliminarDiagnostico('${d.id}')">üóëÔ∏è</button>
                            </div>
                        `;
                    }).join('') || '<p>No hay diagn√≥sticos</p>';
                },

                nuevoDiagnostico: function() {
                    const estudianteId = document.getElementById('diag-estudiante').value;
                    const fecha = prompt('Fecha:', new Date().toISOString().split('T')[0]);
                    const areaCognoscitiva = prompt('√Årea cognoscitiva:');
                    
                    ModeloMEP.diagnosticos.push({
                        id: Repositorio.generarId(),
                        estudianteId,
                        fecha,
                        areaCognoscitiva
                    });

                    Repositorio.guardarTodo();
                    this.cargarDiagnosticos();
                },

                eliminarDiagnostico: function(id) {
                    if (confirm('¬øEliminar este diagn√≥stico?')) {
                        ModeloMEP.diagnosticos = ModeloMEP.diagnosticos.filter(d => d.id !== id);
                        Repositorio.guardarTodo();
                        this.cargarDiagnosticos();
                    }
                },

                // ==================== PESTA√ëA 12: COMUNIDAD ====================
                renderComunidad: function(container) {
                    container.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üë• Comunidad Docente</h2>
                            </div>
                            
                            <div class="ayuda-pedagogica">
                                <p>Comparta experiencias y recursos con colegas.</p>
                            </div>

                            <button class="btn btn-comunidad" onclick="UI.nuevaPublicacion()">üí¨ Nueva Publicaci√≥n</button>

                            <div id="foro-lista" class="mt-3"></div>
                        </div>
                    `;
                    this.cargarForo();
                },

                cargarForo: function() {
                    const lista = document.getElementById('foro-lista');
                    const posts = ModeloMEP.foro;
                    
                    lista.innerHTML = posts.map(p => `
                        <div class="foro-mensaje">
                            <h5>${p.titulo}</h5>
                            <p>${p.mensaje}</p>
                            <p><small>${p.usuario} ¬∑ ${p.fecha}</small></p>
                        </div>
                    `).join('') || '<p>No hay publicaciones</p>';
                },

                nuevaPublicacion: function() {
                    const titulo = prompt('T√≠tulo:');
                    const mensaje = prompt('Mensaje:');
                    
                    ModeloMEP.foro.push({
                        id: Repositorio.generarId(),
                        usuario: 'Docente',
                        fecha: new Date().toISOString().split('T')[0],
                        titulo,
                        mensaje
                    });

                    Repositorio.guardarTodo();
                    this.cargarForo();
                },

                // Placeholders para funciones de edici√≥n
                editarInstitucion: function(id) { alert('Editar instituci√≥n'); },
                editarEstudiante: function(id) { alert('Editar estudiante'); },
                editarAdecuacion: function(id) { alert('Editar adecuaci√≥n'); },
                editarPIAD: function(id) { alert('Editar PIAD'); },
                editarIndicador: function(id) { alert('Editar indicador'); },
                editarUnidad: function(id) { alert('Editar unidad'); }
            };

            // Exponer UI globalmente
            window.UI = UI;

            // Inicializar
            document.addEventListener('DOMContentLoaded', () => UI.init());
        })();
    </script>
</body>
</html>
